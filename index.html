<!DOCTYPE html>
<html lang="en">

<!-- This is a demonstration of HTML5 goodness with healthy does of CSS3 mixed in -->
<head>
  <title>API Cupid</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script>
  <script src="lib/modernizr-2.0.6.js" type="text/javascript"></script>
  <script src="lib/jqote2.js" type="text/javascript"></script>
    
  <script src="js/jquery.anchor.js" type="text/javascript"></script>
  <script src="js/jquery.fancybox-1.2.6.pack.js" type="text/javascript"></script>
      
  <script type="text/x-jqote-template" id="question">
      <![CDATA[
        <p><%=this.text%></p>
        <a class="answer" id="<%=this.key%>_1" href="#yes">Yes</a>&nbsp;
        <a class="answer" id="<%=this.key%>_0" href="#no">No</a>&nbsp;
      ]]>
  </script>
    <!--[if IE]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!--[if IE 7]>
    	<link rel="stylesheet" href="ie7.css" type="text/css" media="screen" />
    <![endif]-->
    
    <link rel="stylesheet" href="style.css" type="text/css" media="screen" />
</head>
<body>
  <header> <!-- HTML5 header tag -->
    <div id="headercontainer">
      <h1><a class="introlink anchorLink" href="#intro">API Cupid</a></h1>
      
      <div>
      <br /><br /><br />
      <input type="text" name="keyword" value="" placeholder="Keyword Search" />
      <br /><br />
    
      <div id="questions"></div>
      </div>
	
  		<div id="categories">
      <p>API By Category:</p>
  			<ul>
	    
  				<li><a class="contactlink anchorLink" href="#contact">Event/Calendar Functionality</a></li>
  				<li><a class="aboutlink anchorLink" href="#about">Financial Requirements</a></li>
  				<li><a class="geolocationlink anchorLink" href="#geolocation">Geolocation</a></li><br />
  				<li><a class="portfoliolink anchorLink" href="#portfolio">Mobile/Table Ability</a></li>
  			</ul>				
  		</div>
	
  	</div>

  </header>

    <section id="contentcontainer"> <!-- HTML5 section tag for the content 'section' -->
    	<section id="portfolio"> <!-- HTML5 section tag for the portfolio 'section' -->
    	
    		<h2 class="work">Your API Suggestions</h2>
    		<div id="apis">
    		<ul class="work">
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    			<li>
    				<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>
    			</li>
    		</ul>
    		</div>
    	</section>
    			
    	<section id="about"> <!-- HTML5 section tag for the about 'section' -->
    	
    		<h2 class="about">About Me</h2>
    		
    		<p>Now this is a story all about how my life got twisted upside down and I'd like to take a minute just sit right there I'll tell you how I became the prince of a town called Bel-Air. In West Philadelphia born and raised on the playground my momma said most of my days chilling out, maxing and relaxing all cool and all shooting some b-ball outside of school when a couple of guys they were up to no good started making trouble in our neighbourhood I got in one little fight and my mom got scared, she said your moving in with your auntie and uncle in Bel-Air</p>
    	
    	</section>
    			
    	<section id="contact"> <!-- HTML5 section tag for the contact 'section' -->
    	
    		<h2 class="contact">Contact Me</h2>
    		
    		<p>I whistled for a cab and when it came near the license plate said fresh and had dice in the mirror, if anything I could say that this cab was rare but I thought nah, <a href="">forget it</a>, yo home to Bel-Air! I pulled up to the house about seven or eight I yelled to the cabbie yo home, smell you later, looked at my kingdom I was finally there to sit on my throne as the prince of Bel-Air</p>
    		
    		<form id="contactform"> 

    			<p><label for="name">Name</label></p> 
    			<input type="text" id=name name=name placeholder="First and last name" required tabindex="1" /> 
    			 
    			<p><label for="email">Email</label></p> 
    			<input type="text" id=email name=email placeholder="example@domain.com" required tabindex="2" /> 
    			 
    			<p><label for="comment">Your Message</label></p> 
    			<textarea name="comment" id="comment" tabindex="4"></textarea> 
    			 
    			<input name="submit" type="submit" id="submit" tabindex="5" value="Send Message" /> 
    			 
    		</form> 

    	
    	</section>
    			
    	<footer> <!-- HTML5 footer tag -->
    	
    		<ul>
    			<li><img src="images/twitter.png" alt="" /><a href="http://twitter.com/tkenny">Follow me on Twitter</a></li>
    			<li><a href="http://inspectelement.com/articles/code-a-backwards-compatible-one-page-portfolio-with-html5-and-css3">Back to the Tutorial on Inspect Element</a></li>
    		</ul>
    	
    	</footer>	
    
    </section>
    
    <script type="text/javascript">
		var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
		document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<script type="text/javascript">
		try {
		var pageTracker = _gat._getTracker("UA-9207090-1");
		pageTracker._trackPageview();
		} catch(err) {}
	</script>
	
  <script>
  $(document).ready(function() {
    var corpus;
    var questions;
    jQuery.getJSON('data/corpus.json', function(data){
      corpus = data;
      renderApis(corpus);
    });

    jQuery.getJSON('data/questions.json', function(data){
      questions = data;
      renderQuestions(questions);
    });

    $('.question').each(function() {
      $(this).val( localStorage['apiDateUser.' + $(this).attr('id')]);
    });

    $('.answer').live('click', function() {
      var answer = $(this).attr('id').split('_');
      localStorage['apiDateUser.' + answer[0]] = answer[1];
      renderApis(corpus);
    });


  });
  
  function renderQuestions(questionList) {
    $.each(questionList, function(key, text) {
      $('#questions').append($('#question').jqote({key: key, text: text}));
    });
  }

  function renderApis(apilist) {
    var attributelist = new Object;
    var apirating = new Object;
    var retvals = new Object;

    // determine the global sutability rating for each api
    $.each(apilist, function(key, val) {
      var rating = checkData(key, val, attributelist);
      apirating[key] = rating;
    });

    $.each(attributelist, function(attribute, apis) {

      // for each attribute, sort the api list by their global suitability
      apis = apis.sort(function(a,b) {
        return apirating[b] - apirating[a];
      });

      // filter down to only the top-ranked apis for each attribute
      // and de-duplicate
      var maxval = -1;
      $.each(apis, function(index, api) {
        if(-1 == maxval) {
          maxval = apirating[api];
        }
        if(maxval == apirating[api]) {
          retvals[api] = apirating[api];
        }
      });
    });

    $('#apis').html('');
    $('#apis').append('<ul class="work">');  
    $.each(retvals, function(api, rating) {
      $('#apis').append('<li>	<a href="http://inspectelement.com"><img src="images/inspectelementSmall.jpg" alt="Inspect Element preview" /></a>' + api + ' - ' + rating + '</li>');
    });
    $('#apis').append('</ul>');
  }

  // sloppily rates the different api matchups by category
  function checkData(apiname, api, attributelist) {
    var rating = 0;
    $.each(api, function(attribute, val) {

      // retrieve the user's response to this question
      var userAttribute = (localStorage['apiDateUser.' + attribute])
      if(userAttribute && (userAttribute == val)) {
        rating += 1;

        // append to list of apis for this attribute
        if(!attributelist[attribute]) {
          attributelist[attribute] = new Array();
        }
        attributelist[attribute].push(apiname);
      }
    });
    return rating;
  }

  if (Modernizr.localstorage) {
    // window.localStorage is available!
  } else {
    console.log("window.localStorage isn't available!")
    // no native support for HTML5 storage :(
    // maybe try dojox.storage or a third-party solution
  }
  </script>
</body>

</html>